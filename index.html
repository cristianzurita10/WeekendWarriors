<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekend Warriors Gold Master</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        body {
            font-family: 'Press Start 2P', cursive;
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e, #0a0a0a);
            min-height: 100vh;
            color: #33cc66
        }

        body.shake {
            animation: screenShake 0.5s ease-in-out;
        }

        @keyframes screenShake {

            0%,
            100% {
                transform: translateX(0)
            }

            10%,
            30%,
            50%,
            70%,
            90% {
                transform: translateX(-5px)
            }

            20%,
            40%,
            60%,
            80% {
                transform: translateX(5px)
            }
        }

        .cmt.goal-home {
            color: #33cc66 !important;
        }

        .cmt.goal-away,
        .cmt.injury,
        .cmt.redcard {
            color: #f44 !important;
        }

        .cmt.chaos {
            color: #D4AF37 !important;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px
        }

        header {
            text-align: center;
            padding: 20px;
            border-bottom: 4px solid #33cc66;
            margin-bottom: 20px;
            position: relative
        }

        h1 {
            font-size: 16px;
            color: #D4AF37;
            text-shadow: 2px 2px #8B6914
        }

        .subtitle {
            font-size: 8px;
            color: #33cc66;
            margin-top: 8px
        }

        .lang-toggle {
            position: absolute;
            top: 20px;
            right: 20px
        }

        .lang-btn {
            font-family: inherit;
            background: 0;
            border: 2px solid #D4AF37;
            color: #D4AF37;
            padding: 5px 8px;
            cursor: pointer;
            font-size: 7px
        }

        .lang-btn.active {
            background: #D4AF37;
            color: #000
        }

        .help-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            font-family: inherit;
            background: #333;
            border: 2px solid #9966ff;
            color: #9966ff;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 10px;
            border-radius: 50%
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 20px;
            padding: 10px;
            background: rgba(0, 0, 0, .5);
            border: 3px solid #33cc66
        }

        .stat {
            text-align: center
        }

        .stat-lbl {
            font-size: 6px;
            color: #D4AF37
        }

        .stat-val {
            font-size: 11px;
            color: #33cc66
        }

        .screen {
            display: none;
            padding: 15px;
            background: rgba(0, 0, 0, .3);
            border: 2px solid #33cc66;
            min-height: 400px
        }

        .screen.active {
            display: block
        }

        .title {
            font-size: 12px;
            color: #D4AF37;
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #33cc66
        }

        .btn {
            font-family: inherit;
            background: linear-gradient(180deg, #2a5a2a, #1a3a1a);
            border: 3px solid #33cc66;
            color: #33cc66;
            padding: 10px 15px;
            cursor: pointer;
            font-size: 8px;
            width: 100%;
            margin-bottom: 8px;
            transition: .2s
        }

        .btn:hover {
            box-shadow: 0 0 15px rgba(51, 204, 102, .4)
        }

        .btn:disabled {
            opacity: .5;
            cursor: not-allowed
        }

        .btn-gold {
            background: linear-gradient(180deg, #D4AF37, #8B6914);
            border-color: #FFD700;
            color: #000
        }

        .btn-red {
            background: linear-gradient(180deg, #8B0000, #4a0000);
            border-color: #f44;
            color: #f44
        }

        .btn-purple {
            background: linear-gradient(180deg, #4a2a6a, #2a1a4a);
            border-color: #96f;
            color: #96f
        }

        .btn.flash {
            animation: flash .3s 2
        }

        @keyframes flash {

            0%,
            100% {
                background: #8B0000
            }

            50% {
                background: #f00
            }
        }

        .grid2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px
        }

        .section {
            background: rgba(0, 0, 0, .4);
            border: 2px solid #33cc66;
            padding: 12px;
            margin-bottom: 12px
        }

        .section-title {
            font-size: 9px;
            color: #D4AF37;
            margin-bottom: 10px;
            text-align: center
        }

        .player {
            background: rgba(0, 0, 0, .6);
            border: 2px solid #33cc66;
            padding: 8px;
            margin-bottom: 6px;
            display: grid;
            grid-template-columns: 25px 1fr auto;
            gap: 8px;
            align-items: center
        }

        .player.sel {
            border-color: #D4AF37;
            background: rgba(212, 175, 55, .1)
        }

        .player.tired {
            border-color: #fa0
        }

        .player.hurt {
            border-color: #f44;
            opacity: .6
        }

        .player input {
            width: 18px;
            height: 18px;
            cursor: pointer
        }

        .p-info {
            font-size: 7px
        }

        .p-name {
            color: #D4AF37;
            margin-bottom: 3px
        }

        .p-stats {
            color: #aaa
        }

        .energy {
            height: 5px;
            background: #333;
            margin-top: 3px
        }

        .energy-fill {
            height: 100%;
            transition: .3s
        }

        .e-hi {
            background: #3c6
        }

        .e-mid {
            background: #fa0
        }

        .e-lo {
            background: #f44
        }

        .merc {
            background: rgba(0, 0, 0, .6);
            border: 2px solid #f0f;
            padding: 10px;
            margin-bottom: 8px
        }

        .merc-name {
            color: #f0f;
            font-size: 9px;
            margin-bottom: 6px
        }

        .merc-stats {
            font-size: 7px;
            color: #aaa
        }

        .league-tbl {
            width: 100%;
            border-collapse: collapse;
            font-size: 7px
        }

        .league-tbl th,
        .league-tbl td {
            padding: 6px 3px;
            border-bottom: 1px solid #333;
            text-align: center
        }

        .league-tbl th {
            background: #1a3a1a;
            color: #D4AF37
        }

        .league-tbl .me {
            background: rgba(212, 175, 55, .15);
            color: #D4AF37
        }

        .pichichi {
            font-size: 7px
        }

        .pichichi-item {
            padding: 5px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between
        }

        .pichichi-item:first-child {
            color: #D4AF37;
            background: rgba(212, 175, 55, .1)
        }

        .match-hdr {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 12px;
            background: rgba(0, 0, 0, .5);
            border: 2px solid #D4AF37
        }

        .team {
            font-size: 9px;
            color: #3c6;
            max-width: 100px;
            text-align: center
        }

        .score {
            font-size: 24px;
            color: #D4AF37
        }

        .vs {
            font-size: 9px;
            color: #666
        }

        .time {
            font-size: 11px;
            color: #D4AF37;
            text-align: center;
            margin-bottom: 8px
        }

        .pitch {
            height: 90px;
            border: 3px solid #3c6;
            position: relative;
            margin-bottom: 12px;
            overflow: hidden
        }

        .pitch-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 25px;
            height: 25px;
            border: 2px solid rgba(255, 255, 255, .2);
            border-radius: 50%
        }

        .ball {
            position: absolute;
            font-size: 14px;
            transition: .5s
        }

        .mute-btn {
            position: absolute;
            top: 20px;
            left: 60px;
            font-family: inherit;
            background: #333;
            border: 2px solid #fa0;
            color: #fa0;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 10px;
            border-radius: 50%
        }

        .weather-icon {
            font-size: 16px;
            margin-left: 10px
        }

        .pitch.rainy {
            background: linear-gradient(to bottom, #1a3a3a, #0a2a2a) !important
        }

        .pitch.rainy::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(transparent 0%, rgba(100, 150, 200, .3) 100%);
            pointer-events: none;
            animation: rain 0.5s linear infinite
        }

        @keyframes rain {
            0% {
                background-position: 0 0
            }

            100% {
                background-position: 0 20px
            }
        }

        .pitch.heat {
            background: linear-gradient(to bottom, #4a3a1a, #3a2a0a) !important;
            filter: sepia(30%)
        }

        .trophy-list {
            max-height: 200px;
            overflow-y: auto;
            font-size: 7px
        }

        .trophy-item {
            padding: 8px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between
        }

        .trophy-item.champ {
            color: #D4AF37;
            background: rgba(212, 175, 55, .1)
        }

        .comm {
            background: rgba(0, 0, 0, .7);
            border: 2px solid #3c6;
            height: 100px;
            overflow-y: auto;
            padding: 6px;
            font-size: 7px
        }

        .cmt {
            padding: 5px;
            border-bottom: 1px solid rgba(51, 204, 102, .2);
            color: #ccc
        }

        .cmt.home {
            background: rgba(212, 175, 55, .2);
            color: #D4AF37;
            border-left: 3px solid #D4AF37
        }

        .cmt.away {
            background: rgba(255, 68, 68, .2);
            color: #f66;
            border-left: 3px solid #f44
        }

        .ht-box {
            margin-top: 15px
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, .9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000
        }

        .modal.active {
            display: flex
        }

        .modal-box {
            background: linear-gradient(135deg, #1a1a2e, #0a0a1e);
            border: 4px solid #D4AF37;
            padding: 20px;
            max-width: 380px;
            text-align: center
        }

        .modal-icon {
            font-size: 36px;
            margin-bottom: 12px
        }

        .modal-title {
            font-size: 11px;
            color: #D4AF37;
            margin-bottom: 12px
        }

        .modal-desc {
            font-size: 8px;
            color: #aaa;
            margin-bottom: 15px;
            line-height: 1.5
        }

        .interview {
            background: rgba(0, 0, 0, .5);
            border: 2px solid #96f;
            padding: 12px;
            margin-bottom: 12px
        }

        .interview-q {
            font-size: 8px;
            color: #96f;
            margin-bottom: 12px
        }

        .fan-bar {
            height: 18px;
            background: #333;
            border: 2px solid #96f;
            margin-bottom: 12px
        }

        .fan-fill {
            height: 100%;
            background: linear-gradient(90deg, #96f, #c9f);
            transition: .3s
        }

        .upgrade {
            background: rgba(0, 0, 0, .5);
            border: 2px solid #D4AF37;
            padding: 12px;
            margin-bottom: 8px
        }

        .upgrade.current {
            border-color: #3c6
        }

        .upgrade-name {
            font-size: 9px;
            color: #D4AF37;
            margin-bottom: 6px
        }

        .upgrade-info {
            font-size: 7px;
            color: #aaa
        }

        .stadium-vis {
            height: 70px;
            border: 3px solid #3c6;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px
        }

        .lvl1 {
            background: linear-gradient(to right, #3a2a1a, #4a3a2a, #3a2a1a)
        }

        .lvl2 {
            background: linear-gradient(to right, #2a4a2a, #3a5a3a, #2a4a2a)
        }

        .lvl3 {
            background: linear-gradient(to right, #1a4a1a, #2a6a2a, #1a4a1a)
        }

        .lvl4 {
            background: linear-gradient(to right, #0a3a0a, #1a5a1a, #0a3a0a)
        }

        .hidden {
            display: none !important
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0)
            }

            25% {
                transform: translateX(-5px)
            }

            75% {
                transform: translateX(5px)
            }
        }

        .shake {
            animation: shake .3s 2
        }

        .gameover {
            text-align: center;
            padding: 40px
        }

        .gameover-title {
            font-size: 16px;
            color: #f44;
            margin-bottom: 20px
        }

        .champion-title {
            font-size: 16px;
            color: #D4AF37;
            margin-bottom: 20px
        }

        @keyframes firework {
            0% {
                opacity: 1;
                transform: scale(1)
            }

            100% {
                opacity: 0;
                transform: scale(2)
            }
        }

        .fireworks {
            font-size: 30px;
            animation: firework 1s infinite
        }

        footer {
            text-align: center;
            padding: 12px;
            font-size: 6px;
            color: #666;
            border-top: 2px solid #333;
            margin-top: 15px
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <button class="help-btn" onclick="showTutorial()">?</button>
            <button class="mute-btn" id="mute-btn" onclick="toggleMute()">üîä</button>
            <h1>‚öΩ WEEKEND WARRIORS ‚öΩ</h1>
            <div class="subtitle" id="sub">Sunday League Manager</div>
            <div class="subtitle" id="team-name-display" style="color:#D4AF37;margin-top:4px"></div>
            <div class="subtitle" id="sub">Sunday League Manager</div>
            <div class="lang-toggle">
                <button class="lang-btn active" onclick="setLang('en')">EN</button>
                <button class="lang-btn" onclick="setLang('es')">ES</button>
            </div>
        </header>
        <div class="stats">
            <div class="stat">
                <div class="stat-lbl" id="l-money">MONEY</div>
                <div class="stat-val" id="v-money">$500</div>
            </div>
            <div class="stat">
                <div class="stat-lbl" id="l-morale">MORALE</div>
                <div class="stat-val" id="v-morale">50%</div>
            </div>
            <div class="stat">
                <div class="stat-lbl" id="l-fans">FANS</div>
                <div class="stat-val" id="v-fans">50%</div>
            </div>
            <div class="stat">
                <div class="stat-lbl" id="l-week">WEEK</div>
                <div class="stat-val" id="v-week">1</div>
            </div>
            <div class="stat">
                <div class="stat-lbl" id="l-record">RECORD</div>
                <div class="stat-val" id="v-record">0-0-0</div>
            </div>
        </div>
        <div class="screen active" id="s-start">
            <h2 class="title">‚öΩ WEEKEND WARRIORS V7.0 ‚öΩ</h2>
            <div style="text-align:center;margin-top:30px"><button class="btn btn-gold" onclick="newGame()">üÜï NEW
                    GAME</button><button class="btn hidden" onclick="load()" id="btn-cont">üíæ CONTINUE</button>
            </div>
        </div>
        <div class="screen" id="s-sponsor">
            <h2 class="title" id="t-sponsor">ü§ù CHOOSE SPONSOR</h2>
            <div id="sponsor-grid"></div>
        </div>
        <div class="screen" id="s-hq">
            <h2 class="title" id="t-hq">üç∫ LA CANTINA</h2>
            <div class="section">
                <div class="section-title" id="l-act">ACTIONS</div>
                <div id="act-grid" class="grid2"></div>
            </div>
            <div class="grid2"><button class="btn" onclick="go('squad')">‚öΩ SQUAD</button><button class="btn btn-red"
                    onclick="go('market')">ü§ù MARKET</button><button class="btn btn-purple" onclick="go('league')">üèÜ
                    LEAGUE</button><button class="btn" onclick="go('stadium')">üèüÔ∏è STADIUM</button></div><button
                class="btn" onclick="showTrophy()">üèÜ TROPHY ROOM</button><button class="btn"
                onclick="showSettings()">‚öôÔ∏è SETTINGS</button><button class="btn btn-gold" onclick="preMatch()">‚öΩ PLAY
                MATCH</button>
        </div>
        <div class="screen" id="s-squad">
            <h2 class="title" id="t-squad">‚öΩ SQUAD</h2>
            <div style="font-size:7px;color:#aaa;text-align:center;margin-bottom:12px" id="squad-info">Select 11</div>
            <div id="p-list"></div><button class="btn" onclick="go('hq')">‚Üê BACK</button>
        </div>
        <div class="screen" id="s-market">
            <h2 class="title" id="t-market">ü§ù MARKET</h2>
            <div id="m-list"></div><button class="btn" onclick="go('hq')">‚Üê BACK</button>
        </div>
        <div class="screen" id="s-league">
            <h2 class="title">üèÜ LEAGUE</h2>
            <div id="league-tbl"></div>
            <div class="section" style="margin-top:12px">
                <div class="section-title">ü•á PICHICHI</div>
                <div id="pichichi" class="pichichi"></div>
            </div><button class="btn" onclick="go('hq')">‚Üê BACK</button>
        </div>
        <div class="screen" id="s-stadium">
            <h2 class="title">üèüÔ∏è STADIUM</h2>
            <div id="stad-vis" class="stadium-vis lvl1">üèüÔ∏è</div>
            <div id="stad-up"></div><button class="btn" onclick="go('hq')">‚Üê BACK</button>
        </div>
        <div class="screen" id="s-pre">
            <h2 class="title" id="t-pre">‚öΩ PRE-MATCH</h2>
            <div id="pre-content"></div>
        </div>
        <div class="screen" id="s-match">
            <h2 class="title">‚öΩ MATCH DAY</h2>
            <div class="match-hdr">
                <div class="team" id="home-name">YOU</div>
                <div class="score"><span id="home-sc">0</span><span class="vs">-</span><span id="away-sc">0</span></div>
                <div class="team" id="away-name">OPP</div>
            </div>
            <div class="time" id="m-time">0'</div>
            <div id="pitch" class="pitch lvl1">
                <div class="pitch-center"></div>
                <div class="ball" id="ball">‚öΩ</div>
            </div>
            <div class="comm" id="comm"></div>
            <div id="ht-box" class="ht-box hidden"></div>
            <div id="ft-box"></div>
        </div>
        <div class="screen" id="s-post">
            <h2 class="title" id="t-post">üìã REPORT</h2>
            <div id="result" style="font-size:11px;color:#D4AF37;text-align:center;margin-bottom:15px"></div>
            <div class="section">
                <div class="section-title">üí∞ FINANCES</div>
                <div id="fin"></div>
            </div>
            <div class="interview" id="int-box">
                <div class="interview-q" id="int-q"></div>
                <div id="int-ch"></div>
            </div><button class="btn btn-gold hidden" onclick="toHQ()" id="btn-hq">‚Üí CONTINUE</button>
        </div>
        <div class="screen" id="s-over">
            <div class="gameover">
                <div class="gameover-title" id="over-title">üíÄ GAME OVER üíÄ</div>
                <div id="over-msg" style="font-size:8px;color:#aaa;margin-bottom:20px"></div><button
                    class="btn btn-gold" onclick="location.reload()">üîÑ RESTART</button>
            </div>
        </div>
        <div class="screen" id="s-champ">
            <div class="gameover">
                <div class="fireworks">üéÜüèÜüéÜ</div>
                <div class="champion-title">üèÜ CHAMPIONS! üèÜ</div>
                <div style="font-size:8px;color:#aaa;margin-bottom:20px" id="champ-msg"></div><button
                    class="btn btn-gold" onclick="location.reload()">üÜï NEW SEASON</button>
            </div>
        </div>
        <div class="modal" id="m-work">
            <div class="modal-box">
                <div class="modal-icon">üë∑</div>
                <div class="modal-title" id="work-t">WORK</div>
                <div class="modal-desc" id="work-d"></div>
                <div id="work-btn"></div>
            </div>
        </div>
        <div class="modal" id="m-tut">
            <div class="modal-box">
                <div class="modal-icon">üìñ</div>
                <div class="modal-title">TUTORIAL</div>
            </div>
        </div>
        <div class="modal" id="m-trophy">
            <div class="modal-box">
                <div class="modal-icon">üèÜ</div>
                <div class="modal-title">TROPHY ROOM</div>
                <div class="trophy-list" id="trophy-list"></div>
                <button class="btn" onclick="closeTrophy()">OK</button>
            </div>
        </div>
        <div class="modal" id="m-teamname">
            <div class="modal-box">
                <div class="modal-icon">‚öΩ</div>
                <div class="modal-title" id="teamname-title">TEAM NAME</div>
                <input type="text" id="teamname-input"
                    style="width:100%;padding:10px;font-family:inherit;font-size:8px;background:#1a1a2e;border:2px solid #D4AF37;color:#D4AF37;margin-bottom:10px"
                    placeholder="Atl√©tico Barrio">
                <button class="btn btn-gold" onclick="setTeamName()">OK</button>
            </div>
        </div>
        <div class="modal" id="m-settings">
            <div class="modal-box">
                <div class="modal-icon">‚öôÔ∏è</div>
                <div class="modal-title">SETTINGS</div>
                <div style="margin-bottom:15px;text-align:left">
                    <div style="font-size:7px;color:#aaa;margin-bottom:5px">EXPORT SAVE:</div>
                    <textarea id="export-code" readonly
                        style="width:100%;height:60px;font-family:monospace;font-size:6px;background:#1a1a2e;border:2px solid #D4AF37;color:#D4AF37;resize:none"></textarea>
                    <button class="btn" style="font-size:6px;padding:5px;margin-top:5px" onclick="exportSave()">üì§
                        EXPORT</button>
                </div>
                <div style="margin-bottom:15px;text-align:left">
                    <div style="font-size:7px;color:#aaa;margin-bottom:5px">IMPORT SAVE:</div>
                    <textarea id="import-code"
                        style="width:100%;height:60px;font-family:monospace;font-size:6px;background:#1a1a2e;border:2px solid #9966ff;color:#9966ff;resize:none"
                        placeholder="Paste code here..."></textarea>
                    <button class="btn btn-purple" style="font-size:6px;padding:5px;margin-top:5px"
                        onclick="importSave()">üì• IMPORT</button>
                </div>
                <button class="btn" onclick="closeSettings()">OK</button>
            </div>
        </div>
        <footer>¬© 2025 Weekend Warriors V11.0</footer>
    </div>
    <script>
        const L = { en: { sub: "Sunday League Manager", hq: "THE CANTINA", money: "MONEY", morale: "MORALE", fans: "FANS", week: "WEEK", record: "RECORD", sponsorT: "CHOOSE SPONSOR", squadT: "YOUR SQUAD", marketT: "BLACK MARKET", select: "Select 11 starters", sponsors: [{ n: "üçó LUCKY CLUCK", b: "+10 Morale", d: "$30/wk", pay: 30, mor: 10 }, { n: "üîß QUICK TYRES", b: "$80/wk", d: "Nephew", pay: 80, neph: 1 }, { n: "‚ö∞Ô∏è ETERNAL REST", b: "+$25/injury", d: "-5 Morale", inj: 25 }], acts: [{ id: "party", t: "üéâ BENDER", d: "$100", c: 100 }, { id: "beach", t: "üèñÔ∏è BEACH", d: "$200", c: 200 }, { id: "potion", t: "üß™ POTION", d: "$10", c: 10 }], stads: [{ n: "üåø DIRT", tk: 50, inj: 1.2, c: 0 }, { n: "üå≥ PARK", tk: 80, inj: 1, c: 300 }, { n: "üöß FENCED", tk: 120, inj: .8, c: 600 }, { n: "üèüÔ∏è STADIUM", tk: 200, inj: .5, c: 1200 }], ht: [{ id: "orange", t: "üçä ORANGES", d: "+10 Energy" }, { id: "shout", t: "üò§ HAIRDRYER", d: "+10 Morale" }, { id: "bribe", t: "üí∞ BRIBE $50", d: "Ref", c: 50 }], int: [{ q: "Ref blind?", a: [{ t: "Yes!", f: 10, m: -5 }, { t: "Moving on", f: 0, m: 5 }, { t: "We were bad", f: -10, m: 10 }] }], work: ["Boss overtime", "Plumbing", "Shopping"], workT: "WORK EMERGENCY", payW: "PAY $50", letM: "MISS", noMoney: "Not enough!", fire: "FIRE", fireC: "Fire? -10 Morale", names: ["Big Dave", "Mad Dog", "Gaz", "Smithy", "Steve", "Bob", "One Lung", "Two Pints", "Fridge", "Psycho"], jobs: ["Plumber", "Bouncer", "Cabbie", "Builder", "IT", "Nini"], traits: ["Lazy", "Hothead", "Diver", "Smoker", "Late", "Complainer"], teams: ["YOUR TEAM", "REAL CAGUAMA", "ATLETICO HANGOVER", "DEPORTIVO YOLO", "FC BEER BELLIES", "INTER DIVORCE", "UNITED BENDERS", "SPORTING CRUDOS", "AC PARKING", "DYNAMO KEBAB"], comm: { ko: "KICK OFF!", hg: "GOOOAL!", ag: "Goal...", ht: "HALF TIME", ft: "FULL TIME!" }, tut: "‚ö°FATIGUE=Low Skill\nüèüÔ∏èSTADIUM=More $\nüí™MORALE=Better\nüë∑JOBS=Miss games", bankrupt: "BANKRUPT!", champ: "CHAMPIONS!" }, es: { sub: "M√°nager Liguilla", hq: "LA CANTINA", money: "LANA", morale: "MORAL", fans: "PORRA", week: "SEMANA", record: "R√âCORD", sponsorT: "ELIGE SPONSOR", squadT: "TUS TRONCOS", marketT: "MERCADO NEGRO", select: "Elige 11", sponsors: [{ n: "üçó POLLER√çA", b: "+10 Moral", d: "$30/sem", pay: 30, mor: 10 }, { n: "üîß VULCANIZADORA", b: "$80/sem", d: "Sobrino", pay: 80, neph: 1 }, { n: "‚ö∞Ô∏è FUNERALES", b: "+$25/lesi√≥n", d: "-5 Moral", inj: 25 }], acts: [{ id: "party", t: "üéâ PEDA", d: "$100", c: 100 }, { id: "beach", t: "üèñÔ∏è PLAYA", d: "$200", c: 200 }, { id: "potion", t: "üß™ TONAY√ÅN", d: "$10", c: 10 }], stads: [{ n: "üåø BALD√çO", tk: 50, inj: 1.2, c: 0 }, { n: "üå≥ PARQUE", tk: 80, inj: 1, c: 300 }, { n: "üöß CERCADA", tk: 120, inj: .8, c: 600 }, { n: "üèüÔ∏è ESTADIO", tk: 200, inj: .5, c: 1200 }], ht: [{ id: "orange", t: "üçä NARANJAS", d: "+10 Energ√≠a" }, { id: "shout", t: "üò§ MENTADA", d: "+10 Moral" }, { id: "bribe", t: "üí∞ MORDIDA $50", d: "√Årbitro", c: 50 }], int: [{ q: "¬ø√Årbitro ciego?", a: [{ t: "¬°S√≠!", f: 10, m: -5 }, { t: "Seguimos", f: 0, m: 5 }, { t: "Mal", f: -10, m: 10 }] }], work: ["Patr√≥n overtime", "Plomer√≠a", "Compras"], workT: "EMERGENCIA CHAMBA", payW: "PAGAR $50", letM: "FALTAR", noMoney: "¬°No hay lana!", fire: "DESPEDIR", fireC: "¬øDespedir? -10 Moral", names: ["El Kevin", "El Gordo", "Don Chuy", "El Brayan", "El Abuelo", "El Pelos", "El Chilango", "El Crudo", "El Rata", "El Tuercas"], jobs: ["Taquero", "Alba√±il", "Microbusero", "Nini", "Plomero", "Viene-Viene"], traits: ["Flojo", "Caliente", "Clavadista", "Fumador", "Tard√≥n", "Quejoso"], teams: ["TU EQUIPO", "REAL CAGUAMA", "ATL√âTICO CRUDOS", "DEPORTIVO YOLO", "FC PANZONES", "INTER DIVORCIADOS", "PAP√ÅS BRAVOS", "SPORTING BORRACHINES", "ESTACIONAMIENTO FC", "DINAMO TACOS"], comm: { ko: "¬°ARRANCA!", hg: "¬°GOOOOOL!", ag: "Gol...", ht: "MEDIO TIEMPO", ft: "¬°FINAL!" }, tut: "‚ö°FATIGA=Menos Skill\nüèüÔ∏èESTADIO=M√°s $\nüí™MORAL=Mejor\nüë∑CHAMBAS=Faltan", bankrupt: "¬°QUIEBRA!", champ: "¬°CAMPEONES!" } };
        let lang = 'en', S = { money: 500, morale: 50, fans: 50, week: 1, wins: 0, draws: 0, losses: 0, players: [], agents: [], league: [], scorers: [], sponsor: null, stadLvl: 0, hScore: 0, aScore: 0, opp: "", oppIdx: 0, events: [], evIdx: 0, paused: false, bribed: false, ctx: null };
        function T() { return L[lang] }
        function sfx(t) { try { if (!S.ctx) S.ctx = new (window.AudioContext || window.webkitAudioContext)(); let c = S.ctx, o = c.createOscillator(), g = c.createGain(); o.connect(g); g.connect(c.destination); if (t == 'goal') { o.type = 'square'; o.frequency.setValueAtTime(523, c.currentTime); o.frequency.setValueAtTime(784, c.currentTime + .15); g.gain.setValueAtTime(.2, c.currentTime); o.start(); o.stop(c.currentTime + .3) } else if (t == 'whistle') { o.type = 'square'; o.frequency.setValueAtTime(800, c.currentTime); o.frequency.setValueAtTime(600, c.currentTime + .1); g.gain.setValueAtTime(.15, c.currentTime); o.start(); o.stop(c.currentTime + .2) } else if (t == 'cash') { o.type = 'sine'; o.frequency.setValueAtTime(1200, c.currentTime); g.gain.setValueAtTime(.1, c.currentTime); o.start(); o.stop(c.currentTime + .1) } else if (t == 'error') { o.type = 'sawtooth'; o.frequency.setValueAtTime(100, c.currentTime); g.gain.setValueAtTime(.2, c.currentTime); o.start(); o.stop(c.currentTime + .25) } } catch (e) { } }
        function canPay(cost, btn) { if (S.money >= cost) return true; sfx('error'); if (btn) { let b = document.getElementById(btn); if (b) { b.classList.add('flash'); setTimeout(() => b.classList.remove('flash'), 600) } } alert(T().noMoney); return false }
        function save() { localStorage.setItem('ww5', JSON.stringify({ money: S.money, morale: S.morale, fans: S.fans, week: S.week, wins: S.wins, draws: S.draws, losses: S.losses, players: S.players, sponsor: S.sponsor, stadLvl: S.stadLvl, league: S.league, scorers: S.scorers, agents: S.agents, oppIdx: S.oppIdx })) }
        function load() { try { let d = JSON.parse(localStorage.getItem('ww5')); if (d) { Object.assign(S, d); S.ctx = null; go('hq'); ui(); sfx('cash') } } catch (e) { newGame() } }
        function init() { if (localStorage.getItem('ww5')) document.getElementById('btn-cont').classList.remove('hidden'); ui(); if (!localStorage.getItem('ww_tutorial_seen')) { showTutorial(); localStorage.setItem('ww_tutorial_seen', '1'); } }
        function newGame() { localStorage.removeItem('ww5'); S = { money: 500, morale: 50, fans: 50, week: 1, wins: 0, draws: 0, losses: 0, players: [], agents: [], league: [], scorers: [], sponsor: null, stadLvl: 0, hScore: 0, aScore: 0, opp: "", oppIdx: 0, events: [], evIdx: 0, paused: false, bribed: false, ctx: null }; genTeam(); initLeague(); renderSponsors(); go('sponsor'); ui() }
        function genTeam() { let t = T(); S.players = []; for (let i = 0; i < 14; i++)S.players.push({ id: i, name: t.names[Math.floor(Math.random() * t.names.length)], job: t.jobs[Math.floor(Math.random() * t.jobs.length)], skill: 30 + Math.floor(Math.random() * 40), energy: 70 + Math.floor(Math.random() * 30), trait: t.traits[Math.floor(Math.random() * t.traits.length)], hurt: false, goals: 0, starter: i < 11 }) }
        function initLeague() { let t = T().teams; S.league = t.map((n, i) => ({ name: n, p: 0, w: 0, d: 0, l: 0, gf: 0, ga: 0, pts: 0, me: i === 0 })); S.scorers = [] }
        function go(id) { document.querySelectorAll('.screen').forEach(s => s.classList.remove('active')); document.getElementById('s-' + id).classList.add('active'); if (id == 'squad') renderSquad(); if (id == 'market') renderMarket(); if (id == 'league') renderLeague(); if (id == 'stadium') renderStadium(); if (id == 'hq') renderHQ() }
        function ui() { let t = T(); document.getElementById('sub').textContent = t.sub; document.getElementById('l-money').textContent = t.money; document.getElementById('l-morale').textContent = t.morale; document.getElementById('l-fans').textContent = t.fans; document.getElementById('l-week').textContent = t.week; document.getElementById('l-record').textContent = t.record; document.getElementById('v-money').textContent = '$' + S.money; document.getElementById('v-morale').textContent = S.morale + '%'; document.getElementById('v-fans').textContent = S.fans + '%'; document.getElementById('v-week').textContent = S.week; document.getElementById('v-record').textContent = S.wins + '-' + S.draws + '-' + S.losses }
        function setLang(l) { lang = l; document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active')); document.querySelector(`.lang-btn[onclick="setLang('${l}')"]`).classList.add('active'); ui(); if (S.players.length) renderHQ() }
        function renderSponsors() { let t = T(); document.getElementById('t-sponsor').textContent = t.sponsorT; document.getElementById('sponsor-grid').innerHTML = t.sponsors.map((s, i) => `<div class="section" style="cursor:pointer" onclick="pickSponsor(${i})"><div class="section-title">${s.n}</div><div style="font-size:7px;color:#3c6">‚úÖ${s.b}</div><div style="font-size:7px;color:#f44">‚ö†Ô∏è${s.d}</div></div>`).join('') }
        function pickSponsor(i) { S.sponsor = T().sponsors[i]; sfx('cash'); if (S.sponsor.neph) S.players.push({ id: 99, name: lang == 'en' ? "Nephew" : "Sobrino", job: "Nephew", skill: 5, energy: 100, trait: T().traits[0], hurt: false, goals: 0, starter: true, neph: true }); go('hq') }
        function renderHQ() { let t = T(); document.getElementById('t-hq').textContent = 'üç∫ ' + t.hq; document.getElementById('l-act').textContent = 'üé≠ ACTIONS'; document.getElementById('act-grid').innerHTML = t.acts.map(a => `<button class="btn" id="btn-${a.id}" onclick="doAct('${a.id}')">${a.t}<br><span style="font-size:6px;color:#aaa">${a.d}</span></button>`).join('') }
        function doAct(id) { let t = T(), a = t.acts.find(x => x.id == id); if (!canPay(a.c, 'btn-' + id)) return; S.money -= a.c; sfx('cash'); if (id == 'party') { S.morale = Math.min(100, S.morale + 25); S.players.forEach(p => p.energy = Math.max(0, p.energy - 15)) } else if (id == 'beach') { S.morale = Math.min(100, S.morale + 20); if (Math.random() < .25) { let v = S.players[Math.floor(Math.random() * S.players.length)]; v.hurt = true } } else if (id == 'potion') { let v = S.players[Math.floor(Math.random() * S.players.length)]; v.skill = Math.min(99, v.skill + 15) } save(); ui() }
        function renderSquad() { let t = T(), cnt = S.players.filter(p => p.starter && !p.hurt).length; document.getElementById('t-squad').textContent = t.squadT; document.getElementById('squad-info').textContent = `${t.select} (${cnt}/11)`; document.getElementById('p-list').innerHTML = S.players.map((p, i) => { let ec = p.energy > 60 ? 'e-hi' : p.energy > 30 ? 'e-mid' : 'e-lo', cc = p.hurt ? 'hurt' : p.starter ? 'sel' : p.energy < 50 ? 'tired' : ''; return `<div class="player ${cc}"><input type="checkbox" ${p.starter ? 'checked' : ''} ${p.hurt ? 'disabled' : ''} onchange="togStart(${i})"><div class="p-info"><div class="p-name">${p.name}${p.neph ? ' üë∂' : ''}${p.hurt ? ' ü§ï' : ''}</div><div class="p-stats">‚öΩ${p.skill}|üíº${p.job}|ü•Ö${p.goals}</div><div class="energy"><div class="energy-fill ${ec}" style="width:${p.energy}%"></div></div></div><button class="btn btn-red" style="font-size:6px;padding:5px;width:auto" onclick="fire(${i})">${t.fire}</button></div>` }).join('') }
        function togStart(i) { let p = S.players[i]; if (p.hurt) return; let cnt = S.players.filter(x => x.starter && !x.hurt).length; if (!p.starter && cnt >= 11) { sfx('error'); return } p.starter = !p.starter; renderSquad() }
        function fire(i) { if (S.players.length <= 7) { sfx('error'); return } if (!confirm(T().fireC)) return; S.players.splice(i, 1); S.morale = Math.max(0, S.morale - 10); sfx('error'); save(); ui(); renderSquad() }
        function renderMarket() { if (S.agents.length == 0) genAgents(); document.getElementById('t-market').textContent = T().marketT; document.getElementById('m-list').innerHTML = S.agents.map((m, i) => `<div class="merc"><div class="merc-name">üî•${m.name}</div><div class="merc-stats">‚öΩ${m.skill}|üí∏$${m.cost}|üìÑ${m.games}g</div><button class="btn btn-purple" id="btn-h${i}" style="margin-top:8px" onclick="hire(${i})">HIRE</button></div>`).join('') }
        function genAgents() { let t = T(); S.agents = []; for (let i = 0; i < 3; i++)S.agents.push({ name: t.names[Math.floor(Math.random() * t.names.length)] + (lang == 'en' ? ' Jr' : ' Merc'), skill: 50 + Math.floor(Math.random() * 30), cost: 50 + Math.floor(Math.random() * 100), games: 2 + Math.floor(Math.random() * 3) }) }
        function hire(i) { let m = S.agents[i]; if (!canPay(m.cost, 'btn-h' + i)) return; S.money -= m.cost; sfx('cash'); S.players.push({ id: Date.now(), name: m.name, job: 'Merc', skill: m.skill, energy: 80, trait: T().traits[0], hurt: false, goals: 0, starter: false, merc: true, gLeft: m.games }); S.agents.splice(i, 1); save(); ui(); renderMarket() }
        function renderLeague() { let sorted = [...S.league].sort((a, b) => b.pts - a.pts || (b.gf - b.ga) - (a.gf - a.ga)); let h = '<table class="league-tbl"><tr><th>#</th><th>TEAM</th><th>P</th><th>W</th><th>D</th><th>L</th><th>GD</th><th>PTS</th></tr>'; sorted.forEach((t, i) => { let gd = t.gf - t.ga; h += `<tr class="${t.me ? 'me' : ''}"><td>${i + 1}</td><td style="text-align:left">${t.name}</td><td>${t.p}</td><td>${t.w}</td><td>${t.d}</td><td>${t.l}</td><td>${gd > 0 ? '+' : ''}${gd}</td><td>${t.pts}</td></tr>` }); h += '</table>'; document.getElementById('league-tbl').innerHTML = h; let top = [...S.scorers].sort((a, b) => b.goals - a.goals).slice(0, 5); document.getElementById('pichichi').innerHTML = top.length ? top.map((s, i) => `<div class="pichichi-item"><span>${i + 1}.${s.name}</span><span>‚öΩ${s.goals}</span></div>`).join('') : '<div style="color:#666;text-align:center">No goals</div>' }
        function simAI() { let ai = S.league.filter(t => !t.me).sort(() => Math.random() - .5); for (let i = 0; i < ai.length - 1; i += 2) { let h = ai[i], a = ai[i + 1]; if (!a) continue; let hg = Math.floor(Math.random() * 4), ag = Math.floor(Math.random() * 4); h.p++; a.p++; h.gf += hg; h.ga += ag; a.gf += ag; a.ga += hg; if (hg > ag) { h.w++; h.pts += 3; a.l++ } else if (ag > hg) { a.w++; a.pts += 3; h.l++ } else { h.d++; a.d++; h.pts++; a.pts++ } } }
        function renderStadium() { let t = T().stads; document.getElementById('stad-vis').className = 'stadium-vis lvl' + (S.stadLvl + 1); document.getElementById('stad-vis').innerHTML = t[S.stadLvl].n; document.getElementById('stad-up').innerHTML = t.map((s, i) => { let cur = i == S.stadLvl, nxt = i == S.stadLvl + 1; return `<div class="upgrade ${cur ? 'current' : ''}"><div class="upgrade-name">${s.n}${cur ? ' ‚úÖ' : ''}</div><div class="upgrade-info">üéüÔ∏è$${s.tk}|ü©π${Math.round(s.inj * 100)}%</div>${nxt ? `<button class="btn btn-gold" id="btn-up" style="margin-top:8px" onclick="upStad()">UPGRADE $${s.c}</button>` : ''}</div>` }).join('') }
        function upStad() { let nxt = T().stads[S.stadLvl + 1]; if (!nxt || !canPay(nxt.c, 'btn-up')) return; S.money -= nxt.c; S.stadLvl++; sfx('cash'); save(); ui(); renderStadium() }
        function preMatch() { let starters = S.players.filter(p => p.starter && !p.hurt); if (starters.length < 11) { sfx('error'); go('squad'); return } if (Math.random() < .15) { showWork(); return } go('pre'); renderPre() }
        function showWork() { let avail = S.players.filter(p => p.starter && !p.hurt && !p.neph); if (!avail.length) { go('pre'); renderPre(); return } let v = avail[Math.floor(Math.random() * avail.length)]; S.workV = v; let t = T(); document.getElementById('work-t').textContent = t.workT; document.getElementById('work-d').innerHTML = `<strong>${v.name}</strong><br><br>${t.work[Math.floor(Math.random() * t.work.length)]}`; document.getElementById('work-btn').innerHTML = `<button class="btn btn-gold" onclick="payWork()">${t.payW}</button><button class="btn btn-red" onclick="skipWork()">${t.letM}</button>`; document.getElementById('m-work').classList.add('active') }
        function payWork() { if (!canPay(50)) return; S.money -= 50; sfx('cash'); S.workV = null; document.getElementById('m-work').classList.remove('active'); ui(); go('pre'); renderPre() }
        function skipWork() { S.workV.starter = false; sfx('error'); S.workV = null; document.getElementById('m-work').classList.remove('active'); go('pre'); renderPre() }
        function renderPre() { let ai = S.league.filter(t => !t.me); S.oppIdx = S.oppIdx % ai.length; S.opp = ai[S.oppIdx].name; S.oppIdx++; document.getElementById('t-pre').textContent = lang == 'en' ? '‚öΩ PRE-MATCH' : '‚öΩ PRE-PARTIDO'; document.getElementById('pre-content').innerHTML = `<div class="section"><div class="section-title">${lang == 'en' ? 'OPPONENT' : 'RIVAL'}</div><div style="font-size:12px;color:#D4AF37;text-align:center">${S.opp}</div></div><button class="btn btn-gold" onclick="startMatch()">‚öΩ ${lang == 'en' ? 'KICK OFF' : 'INICIAR'}</button>` }
        function startMatch() { go('match'); sfx('whistle'); S.hScore = 0; S.aScore = 0; S.evIdx = 0; S.paused = false; S.bribed = false; S.events = []; document.getElementById('home-name').textContent = T().teams[0]; document.getElementById('away-name').textContent = S.opp; document.getElementById('home-sc').textContent = '0'; document.getElementById('away-sc').textContent = '0'; document.getElementById('m-time').textContent = "0'"; document.getElementById('comm').innerHTML = ''; document.getElementById('ht-box').innerHTML = ''; document.getElementById('ht-box').classList.add('hidden'); document.getElementById('ft-box').innerHTML = ''; document.getElementById('pitch').className = 'pitch lvl' + (S.stadLvl + 1); document.getElementById('ball').style.left = '50%'; document.getElementById('ball').style.top = '50%'; genEvents(); runMatch() }
        function genEvents() { let str = S.players.filter(p => p.starter && !p.hurt).reduce((s, p) => s + p.skill + (p.energy > 50 ? 10 : -10), 0) / 11; let hc = Math.min(70, Math.max(30, 40 + (str - 50) / 2 + S.morale / 10)); S.events = []; for (let m = 5; m <= 90; m += 5 + Math.floor(Math.random() * 5)) { if (m >= 45 && m < 50) { S.events.push({ min: 45, type: 'ht' }); continue } let r = Math.random() * 100; if (r < 12) S.events.push({ min: m, type: r < hc / 8 ? 'hg' : 'ag' }); else S.events.push({ min: m, type: 'act' }) } S.events.push({ min: 90, type: 'ft' }) }
        function runMatch() { function tick() { if (S.evIdx >= S.events.length || S.paused) return; let e = S.events[S.evIdx]; document.getElementById('m-time').textContent = e.min + "'"; let ball = document.getElementById('ball'); if (e.type == 'hg') { S.hScore++; document.getElementById('home-sc').textContent = S.hScore; sfx('goal'); ball.style.left = '10%'; let sc = S.players.filter(p => p.starter && !p.hurt)[Math.floor(Math.random() * 11)]; if (sc) { sc.goals++; updScorer(sc.name) } addCmt(e.min, T().comm.hg + (sc ? ' (' + sc.name + ')' : ''), 'home') } else if (e.type == 'ag') { if (S.bribed) { S.bribed = false; addCmt(e.min, 'ü§´ Disallowed!', ''); S.evIdx++; setTimeout(tick, 300); return } S.aScore++; document.getElementById('away-sc').textContent = S.aScore; sfx('error'); ball.style.left = '90%'; addCmt(e.min, T().comm.ag, 'away') } else if (e.type == 'ht') { addCmt(45, T().comm.ht, ''); S.paused = true; S.evIdx++; showHT(); return } else if (e.type == 'ft') { sfx('whistle'); addCmt(90, T().comm.ft, ''); showFT(); return } else { ball.style.left = (20 + Math.random() * 60) + '%'; ball.style.top = (20 + Math.random() * 60) + '%' } S.evIdx++; setTimeout(tick, 300 + Math.random() * 200) } addCmt(0, T().comm.ko, ''); tick() }
        function addCmt(m, txt, cls) { let box = document.getElementById('comm'); box.innerHTML += `<div class="cmt ${cls}"><strong>${m}'</strong> - ${txt}</div>`; box.scrollTop = box.scrollHeight }
        function updScorer(n) { let s = S.scorers.find(x => x.name == n); if (s) s.goals++; else S.scorers.push({ name: n, goals: 1 }) }
        function showHT() { let t = T().ht; document.getElementById('ht-box').classList.remove('hidden'); document.getElementById('ht-box').innerHTML = `<div class="section"><div class="section-title">${lang == 'en' ? 'HALF TIME' : 'MEDIO TIEMPO'}</div>${t.map(h => `<button class="btn" id="btn-ht-${h.id}" onclick="htChoice('${h.id}')">${h.t}<br><span style="font-size:6px;color:#aaa">${h.d}</span></button>`).join('')}</div>` }
        function htChoice(id) { let h = T().ht.find(x => x.id == id); if (h.c && !canPay(h.c, 'btn-ht-' + id)) return; if (h.c) S.money -= h.c; if (id == 'orange') S.players.forEach(p => { if (p.starter) p.energy = Math.min(100, p.energy + 10) }); if (id == 'shout') S.morale = Math.min(100, S.morale + 10); if (id == 'bribe') S.bribed = true; sfx('cash'); document.getElementById('ht-box').classList.add('hidden'); S.paused = false; ui(); runMatch() }
        function showFT() { document.getElementById('ft-box').innerHTML = `<div class="section" style="text-align:center"><div style="font-size:14px;color:#D4AF37">${S.hScore}-${S.aScore}</div><button class="btn btn-gold" style="margin-top:12px" onclick="postMatch()">${lang == 'en' ? 'CONTINUE' : 'CONTINUAR'}</button></div>` }
        function postMatch() { go('post'); let pt = S.league.find(t => t.me), ot = S.league.find(t => t.name == S.opp); pt.p++; pt.gf += S.hScore; pt.ga += S.aScore; if (ot) { ot.p++; ot.gf += S.aScore; ot.ga += S.hScore } let res = '', fc = 0; if (S.hScore > S.aScore) { res = `üèÜ ${lang == 'en' ? 'VICTORY' : 'VICTORIA'}! ${S.hScore}-${S.aScore}`; S.wins++; pt.w++; pt.pts += 3; if (ot) ot.l++; fc = 10 } else if (S.hScore < S.aScore) { res = `üíÄ ${lang == 'en' ? 'DEFEAT' : 'DERROTA'} ${S.hScore}-${S.aScore}`; S.losses++; pt.l++; if (ot) { ot.w++; ot.pts += 3 } fc = -10 } else { res = `ü§ù ${lang == 'en' ? 'DRAW' : 'EMPATE'} ${S.hScore}-${S.aScore}`; S.draws++; pt.d++; pt.pts++; if (ot) { ot.d++; ot.pts++ } } S.fans = Math.max(0, Math.min(100, S.fans + fc)); document.getElementById('result').innerHTML = res; let tk = T().stads[S.stadLvl].tk + Math.floor(Math.random() * 50); let wb = S.hScore > S.aScore ? 100 : 0; let sp = S.sponsor?.pay || 0; let dmg = Math.floor(Math.random() * 20); let tot = tk + wb + sp - dmg; S.money += tot; document.getElementById('fin').innerHTML = `<div style="font-size:7px">üéüÔ∏è+$${tk}<br>üèÜ+$${wb}<br>ü§ù+$${sp}<br><span style="color:#f44">ü©π-$${dmg}</span><br><span style="color:#D4AF37">üíµ${tot >= 0 ? '+' : ''}$${tot}</span></div>`; S.players.filter(p => p.starter).forEach(p => { p.energy = Math.max(0, p.energy - 15); if (Math.random() < .04 * T().stads[S.stadLvl].inj) p.hurt = true }); S.players.filter(p => !p.starter && !p.hurt).forEach(p => p.energy = Math.min(100, p.energy + 30)); S.players = S.players.filter(p => !p.merc || --p.gLeft > 0); if (S.sponsor?.mor) S.morale = Math.min(100, S.morale + S.sponsor.mor); showInt() }
        function showInt() { let iv = T().int[0]; document.getElementById('int-q').textContent = `üé§ "${iv.q}"`; document.getElementById('int-ch').innerHTML = iv.a.map((a, i) => `<button class="btn" style="margin-bottom:6px" onclick="ansInt(${i})">"${a.t}"</button>`).join(''); S.curInt = iv }
        function ansInt(i) { let a = S.curInt.a[i]; S.fans = Math.max(0, Math.min(100, S.fans + a.f)); S.morale = Math.max(0, Math.min(100, S.morale + a.m)); sfx('cash'); document.getElementById('int-box').classList.add('hidden'); document.getElementById('btn-hq').classList.remove('hidden'); ui() }
        function toHQ() { S.week++; simAI(); S.agents = []; genAgents(); if (S.money < -500) { localStorage.removeItem('ww5'); go('over'); document.getElementById('over-title').textContent = 'üíÄ GAME OVER üíÄ'; document.getElementById('over-msg').textContent = T().bankrupt; return } if (S.week > 10) { let sorted = [...S.league].sort((a, b) => b.pts - a.pts); if (sorted[0].me) { go('champ'); document.getElementById('champ-msg').textContent = T().champ; localStorage.removeItem('ww5'); return } } save(); document.getElementById('int-box').classList.remove('hidden'); document.getElementById('btn-hq').classList.add('hidden'); ui(); go('hq') }
        function showTutorial() { document.getElementById('tut-txt').textContent = T().tut; document.getElementById('m-tut').classList.add('active') }
        function closeTut() { document.getElementById('m-tut').classList.remove('active') }
        // V6.0 NEW FEATURES
        let muted = false;
        function toggleMute() { muted = !muted; document.getElementById('mute-btn').textContent = muted ? 'üîá' : 'üîä'; }
        const WEATHER = ['normal', 'rainy', 'heat'];
        const WEATHER_ICON = { normal: '‚òÄÔ∏è', rainy: 'üåßÔ∏è', heat: 'üî•' };
        let weather = 'normal';
        function setWeather() { weather = WEATHER[Math.floor(Math.random() * 3)]; }
        function getWeatherMod() { if (weather == 'rainy') return { inj: 1.2, fat: 1.3 }; if (weather == 'heat') return { inj: 1.0, fat: 1.5 }; return { inj: 1, fat: 1 }; }
        // Narrative Events (30 each)
        const NAR = {
            en: ["Big Dave trips over his own feet", "Dog runs onto pitch, chaos ensues", "Someone's kid starts crying on sideline", "Kebab Steve belches loudly", "Ref forgot his cards at home", "Ball goes into neighbour's garden", "Two Pints argues with a cloud", "Goalkeeper examining his fingernails", "Corner flag falls over", "Wobbly Bob claims handball (it hit his face)", "Mad Dog threatens the linesman", "Stray cat distracts the striker", "Someone's phone rings - it's their wife", "Player stops to tie shoelace at worst moment", "Hangover causing visible suffering", "Equipment bag stolen by local teen", "Pitch has suspicious puddles", "Goalkeeper chatting with the fans", "Player forgot his shin pads again", "Ball deflects off a shopping trolley", "Ref is clearly hungover too", "Someone's ex shows up to watch", "Crow steals a water bottle", "Player blames the sun in his eyes", "Psycho kicks the corner flag", "Car alarm goes off during match", "Ice cream van music interrupts play", "One Lung needs his inhaler", "Player's shorts rip dramatically", "Ball hits a spectator's dog"],
            es: ["El Kevin se tropieza solito", "Un perro entra a la cancha", "Un ni√±o llora en la banda", "El Gordo eructa durante el gol", "El √°rbitro olvid√≥ las tarjetas", "El bal√≥n cae en el jard√≠n del vecino", "Don Chuy discute con una nube", "El portero se revisa las u√±as", "Se cae el bander√≠n", "El Crudo alega mano (le peg√≥ en la cara)", "El Brayan amenaza al l√≠nea", "Un gato distrae al delantero", "Suena el celular - es la patrona", "Para a amarrarse los zapatos en mal momento", "La cruda causa sufrimiento visible", "Chamaco roba la maleta", "La cancha tiene charcos sospechosos", "El portero platica con los fans", "Olvid√≥ las espinilleras otra vez", "El bal√≥n pega en un carrito de s√∫per", "El √°rbitro tambi√©n viene crudo", "Llega la ex a verlo", "Un cuervo roba la botella de agua", "Culpa al sol en sus ojos", "El Rata patea el bander√≠n", "Suena alarma de carro", "Pasa el carrito de los helados", "El Abuelo necesita su inhalador", "Se le rompen los shorts", "El bal√≥n le pega al perro de un fan"]
        };
        function getNarrative() { let n = NAR[lang]; return n[Math.floor(Math.random() * n.length)]; }
        // Trophy Room
        function getHistory() { try { return JSON.parse(localStorage.getItem('ww_history')) || []; } catch (e) { return []; } }
        function saveHistory(season, pos, champ) { let h = getHistory(); h.push({ season, pos, champ, date: new Date().toLocaleDateString() }); localStorage.setItem('ww_history', JSON.stringify(h)); }
        function showTrophy() { let h = getHistory(); document.getElementById('trophy-list').innerHTML = h.length ? h.map((s, i) => `<div class="trophy-item ${s.pos == 1 ? 'champ' : ''}"><span>S${s.season}</span><span>#${s.pos} ${s.pos == 1 ? 'üèÜ' : ''}</span><span>${s.date}</span></div>`).join('') : '<div style="color:#666;text-align:center">No history yet</div>'; document.getElementById('m-trophy').classList.add('active'); }
        function closeTrophy() { document.getElementById('m-trophy').classList.remove('active'); }
        // Override sfx with mute check
        const _sfx = sfx;
        sfx = function (t) { if (!muted) _sfx(t); };
        // V10.0 TEAM NAME
        let teamName = localStorage.getItem('ww_teamname') || '';
        function showTeamNameModal() { document.getElementById('teamname-title').textContent = lang == 'en' ? 'TEAM NAME' : 'NOMBRE DEL EQUIPO'; document.getElementById('m-teamname').classList.add('active'); }
        function setTeamName() { let n = document.getElementById('teamname-input').value.trim(); teamName = n || (lang == 'en' ? 'Atl√©tico Barrio' : 'Atl√©tico Barrio'); localStorage.setItem('ww_teamname', teamName); document.getElementById('m-teamname').classList.remove('active'); updateTeamDisplay(); L.en.teams[0] = teamName; L.es.teams[0] = teamName; go('sponsor'); }
        function updateTeamDisplay() { document.getElementById('team-name-display').textContent = teamName ? 'üìã ' + teamName : ''; }
        // SCREEN SHAKE
        function screenShake() { document.body.classList.add('shake'); setTimeout(() => document.body.classList.remove('shake'), 500); }
        // Override startMatch to add weather + strict 11 validation
        const _startMatch = startMatch;
        startMatch = function () { let starters = S.players.filter(p => p.starter && !p.hurt); if (starters.length !== 11) { alert(lang == 'en' ? 'Need exactly 11 healthy starters!' : '¬°Necesitas exactamente 11 titulares sanos!'); sfx('error'); go('squad'); return; } setWeather(); _startMatch(); let p = document.getElementById('pitch'); p.classList.remove('rainy', 'heat'); if (weather != 'normal') p.classList.add(weather); document.getElementById('m-time').innerHTML = "0' " + WEATHER_ICON[weather]; };
        // Override addCmt with chaos class + screen shake on goals
        const _addCmt = addCmt;
        addCmt = function (m, txt, cls) { let finalCls = cls; if (cls == 'home') { finalCls = 'goal-home'; screenShake(); } else if (cls == 'away') { finalCls = 'goal-away'; } _addCmt(m, txt, finalCls); if (cls == '' && Math.random() < 0.25) { setTimeout(() => { let box = document.getElementById('comm'); box.innerHTML += `<div class="cmt chaos"><strong>${m}'</strong> - üì¢ ${getNarrative()}</div>`; box.scrollTop = box.scrollHeight; }, 200); } };
        // Override postMatch for 50% fatigue reduction + weather
        const _postMatch = postMatch;
        postMatch = function () { let wm = getWeatherMod(); S.players.filter(p => p.starter).forEach(p => { p.energy = Math.max(0, p.energy - Math.floor(7.5 * wm.fat * 0.5)); }); _postMatch(); };
        // Override toHQ for season history
        const _toHQ = toHQ;
        toHQ = function () { if (S.week >= 10) { let sorted = [...S.league].sort((a, b) => b.pts - a.pts); let pos = sorted.findIndex(t => t.me) + 1; saveHistory(getHistory().length + 1, pos, sorted[0].name); } _toHQ(); };
        // Override htChoice for bribe mechanic (60% goal, 40% red card)
        const _htChoice = htChoice;
        htChoice = function (id) { if (id == 'bribe') { if (!canPay(50, 'btn-ht-bribe')) return; S.money -= 50; if (Math.random() < 0.6) { S.hScore++; document.getElementById('home-sc').textContent = S.hScore; sfx('goal'); addCmt(45, lang == 'en' ? 'ü§´ Ref accepts! PENALTY GOAL!' : 'ü§´ ¬°√Årbitro acepta! ¬°GOL DE PENAL!', 'home'); screenShake(); } else { let starters = S.players.filter(p => p.starter && !p.hurt); if (starters.length > 0) { let victim = starters[Math.floor(Math.random() * starters.length)]; victim.hurt = true; sfx('error'); addCmt(45, lang == 'en' ? 'üò° Ref offended! RED CARD for ' + victim.name + '!' : 'üò° ¬°√Årbitro ofendido! ¬°ROJA para ' + victim.name + '!', ''); screenShake(); } } document.getElementById('ht-box').classList.add('hidden'); S.paused = false; ui(); runMatch(); return; } _htChoice(id); };
        // Override newGame to show team name modal
        const _newGame = newGame;
        newGame = function () { if (!localStorage.getItem('ww_teamname')) { _newGame(); showTeamNameModal(); } else { teamName = localStorage.getItem('ww_teamname'); L.en.teams[0] = teamName; L.es.teams[0] = teamName; updateTeamDisplay(); _newGame(); } };
        // Override init to update team display
        const _init = init;
        init = function () { teamName = localStorage.getItem('ww_teamname') || ''; if (teamName) { L.en.teams[0] = teamName; L.es.teams[0] = teamName; } updateTeamDisplay(); _init(); };
        // V11.0 SETTINGS & DATA PORTABILITY
        function showSettings() { document.getElementById('export-code').value = ''; document.getElementById('import-code').value = ''; document.getElementById('m-settings').classList.add('active'); }
        function closeSettings() { document.getElementById('m-settings').classList.remove('active'); }
        function exportSave() { try { let data = { money: S.money, morale: S.morale, fans: S.fans, week: S.week, wins: S.wins, draws: S.draws, losses: S.losses, players: S.players, sponsor: S.sponsor, stadLvl: S.stadLvl, league: S.league, scorers: S.scorers, agents: S.agents, oppIdx: S.oppIdx, teamName: teamName }; let code = btoa(JSON.stringify(data)); document.getElementById('export-code').value = code; sfx('cash'); } catch (e) { alert('Export failed!'); } }
        function importSave() { try { let code = document.getElementById('import-code').value.trim(); if (!code) { alert('Paste a code first!'); return; } let data = JSON.parse(atob(code)); if (!data.money || !data.players || !data.league) throw new Error('Invalid save'); Object.assign(S, data); if (data.teamName) { teamName = data.teamName; localStorage.setItem('ww_teamname', teamName); L.en.teams[0] = teamName; L.es.teams[0] = teamName; updateTeamDisplay(); } S.ctx = null; save(); sfx('cash'); alert(lang == 'en' ? 'Save imported!' : '¬°Partida importada!'); closeSettings(); go('hq'); ui(); } catch (e) { sfx('error'); alert(lang == 'en' ? 'Invalid code!' : '¬°C√≥digo inv√°lido!'); } }
        // V11.0 BLACK MARKET ITEMS
        function healPlayer(i) { let p = S.players[i]; if (!p.hurt) { sfx('error'); alert(lang == 'en' ? 'Player not injured!' : '¬°Jugador no lesionado!'); return; } if (!canPay(500, 'btn-heal-' + i)) return; S.money -= 500; p.hurt = false; sfx('cash'); save(); ui(); renderSquad(); }
        function boostEnergy(i) { let p = S.players[i]; if (p.energy >= 100) { sfx('error'); alert(lang == 'en' ? 'Already at max energy!' : '¬°Ya tiene m√°xima energ√≠a!'); return; } if (!canPay(300, 'btn-boost-' + i)) return; S.money -= 300; p.energy = 100; sfx('cash'); save(); ui(); renderSquad(); }
        // Override renderSquad to add Black Market buttons
        const _renderSquad = renderSquad;
        renderSquad = function () { let t = T(), cnt = S.players.filter(p => p.starter && !p.hurt).length; document.getElementById('t-squad').textContent = t.squadT; document.getElementById('squad-info').textContent = `${t.select} (${cnt}/11)`; document.getElementById('p-list').innerHTML = S.players.map((p, i) => { let ec = p.energy > 60 ? 'e-hi' : p.energy > 30 ? 'e-mid' : 'e-lo', cc = p.hurt ? 'hurt' : p.starter ? 'sel' : p.energy < 50 ? 'tired' : ''; let shopBtns = ''; if (p.hurt) shopBtns = `<button class="btn btn-gold" id="btn-heal-${i}" style="font-size:5px;padding:3px;width:auto" onclick="healPlayer(${i})">üè•$500</button>`; else if (p.energy < 100) shopBtns = `<button class="btn btn-purple" id="btn-boost-${i}" style="font-size:5px;padding:3px;width:auto" onclick="boostEnergy(${i})">üß™$300</button>`; return `<div class="player ${cc}"><input type="checkbox" ${p.starter ? 'checked' : ''} ${p.hurt ? 'disabled' : ''} onchange="togStart(${i})"><div class="p-info"><div class="p-name">${p.name}${p.neph ? ' üë∂' : ''}${p.hurt ? ' ü§ï' : ''}</div><div class="p-stats">‚öΩ${p.skill}|üíº${p.job}|ü•Ö${p.goals}</div><div class="energy"><div class="energy-fill ${ec}" style="width:${p.energy}%"></div></div></div>${shopBtns}<button class="btn btn-red" style="font-size:6px;padding:5px;width:auto" onclick="fire(${i})">${t.fire}</button></div>` }).join('') };
        // Update fatigue to 0.8x in postMatch override
        postMatch = function () { let wm = getWeatherMod(); S.players.filter(p => p.starter).forEach(p => { p.energy = Math.max(0, p.energy - Math.floor(15 * wm.fat * 0.8)); }); _postMatch(); };
        window.onload = init;
    </script>
</body>

</html>